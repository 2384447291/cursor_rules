Mermaid 稳定输出规范
输出格式

生成 Mermaid 时只输出一个 Mermaid 代码块 不要输出任何额外文字

代码块外不要夹带解释 说明 清单 或其他内容

字符与编码 最关键

Mermaid 代码中只允许 ASCII 字符

label 推荐只用 字母 数字 空格 连字符 下划线 点 逗号 圆括号

禁止任何非 ASCII 字符 包括中文 韩文 emoji 以及特殊符号

禁止出现反斜杠 字符

禁止出现转义序列 例如 n t r

禁止在节点 label 内使用竖线字符

图类型

只使用 flowchart TB

禁止混用其他 Mermaid 图类型

subgraph 写法

所有 subgraph 标题必须加引号

必须使用 subgraph ID["Title"]

禁止使用 subgraph ID[Title]

节点写法

所有节点必须使用带引号的 label

必须使用 ID["label"]

label 必须单行

禁止多行 label

禁止使用 br 标签

label 尽量短 不超过 80 个字符

复杂说明放到图外的文字里 不要塞进节点

边 连线

只用基础连线 A --> B

尽量不要使用带文字的连线标注

如必须使用连线文字 标注必须 ASCII 单行 且很短

禁用项 高风险语法

禁止注释块

禁止花哨标点或引号变体

禁止超长节点文本

推荐结构 固定分区

需要分区时最多使用三个分区 APP UP NIC

APP 表示应用入口 你会直接调用的函数

UP 表示库的上游关键入口函数

NIC 表示目标文件内函数 需要列全

除非用户明确要求 否则不要画 libc pthread socket osal 等下游依赖

生成前自检清单

Mermaid 代码中不包含任何非 ASCII 字符

Mermaid 代码中不包含任何反斜杠字符

所有 subgraph 都是 subgraph ID["..."]

所有节点都是 ID["..."] 且单行

图中只使用 flowchart TB

节点 label 不超过 80 个字符
